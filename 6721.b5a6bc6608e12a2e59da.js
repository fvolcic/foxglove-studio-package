"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6721],{43809:(rt,me,a)=>{a.d(me,{Z:()=>Ue});var i=a(52322),Te=a(47746),oe=a(20379),S=a(17055),fe=a(86232),_=a(76635),o=a(2784),ve=a(87438),De=a(40010),W=a(8740),U=a(94225),se=a(91004),$e=a(667),Ne=a(23503),ut=a(25934),Fe=a(86451),dt=a(61187),ue=a(93812),ye=a(86495),ie=a(77075),ct=a(23144),mt=a(7565);const le=(0,W.ZL)()(f=>({root:{fontFamily:ie.R.MONOSPACE,fontSize:f.typography.caption.fontSize,lineHeight:f.typography.caption.lineHeight,overflowWrap:"break-word"},grid:{columnGap:f.spacing(.5),display:"grid",gridTemplateColumns:"auto minmax(0px, max-content) minmax(auto, max-content)",alignItems:"center",fontFamily:ie.R.MONOSPACE,fontSize:f.typography.caption.fontSize,lineHeight:f.typography.caption.lineHeight,overflowWrap:"break-word"},icon:{gridColumn:"1",height:12,width:12},path:{opacity:.9,whiteSpace:"nowrap"},value:{fontWeight:600,paddingLeft:f.spacing(2)},overflow:{gridColumn:"2/4",opacity:f.palette.action.disabledOpacity,fontStyle:"italic",":not(:last-child)":{marginBottom:f.spacing(.5)}}}));function Ie(){const{classes:f}=le();return(0,i.jsx)("div",{className:f.overflow,children:"<multiple values under cursor>"})}function ft(f){const{colorsByDatasetIndex:T,content:G,labelsByDatasetIndex:de,multiDataset:D}=f,{classes:I,cx:V}=le(),y=(0,o.useMemo)(()=>{const C=new Map,A=new Set;if(!D)return{out:C,overflow:A};for(const F of G){const O=C.get(F.path)??[];O.push(F),C.set(F.path,O),O.length>1&&A.add(F.path)}return{out:C,overflow:A}},[G,D]);if(!D)return(0,i.jsxs)(ue.Z,{className:I.root,"data-testid":"TimeBasedChartTooltipContent",children:[(0,_.take)(G,1).map((C,A)=>{const F=typeof C.value=="string"?C.value:typeof C.value=="bigint"?C.value.toString():JSON.stringify(C.value);return(0,i.jsxs)("div",{children:[F,C.constantName!=null?` (${C.constantName})`:""]},A)}),G.length>1&&(0,i.jsx)(Ie,{})]});const R=(0,_.sortBy)([...y.out.entries()],([C,A])=>A[0]?.datasetIndex??0);return(0,i.jsx)("div",{className:V(I.root,I.grid),"data-testid":"TimeBasedChartTooltipContent",children:R.map(([C,A],F)=>{const O=A[0],N=O?.datasetIndex!=null?T?.[O.datasetIndex]:"auto",K=O?.datasetIndex!=null?de?.[O.datasetIndex]:void 0;return(0,i.jsxs)(o.Fragment,{children:[(0,i.jsx)(mt.In2,{className:I.icon,primaryFill:N}),(0,i.jsx)("div",{className:I.path,children:K??C}),(0,_.take)(A,1).map((X,ce)=>{const ee=typeof X.value=="string"?X.value:typeof X.value=="bigint"?X.value.toString():JSON.stringify(X.value);return(0,i.jsxs)("div",{className:I.value,children:[ee,X.constantName!=null?` (${X.constantName})`:""]},ce)}),y.overflow.has(C)&&(0,i.jsx)(Ie,{})]},F)})})}var ht=a(63718);function xt(f,T){if(f.data.length<=1)return f;const G=T.width/(T.x.max-T.x.min),de=T.height/(T.y.max-T.y.min),D=[];let I,V,y,R;const C=T.x.max-T.x.min,A=T.x.min-C*.5,F=T.x.max+C*.5;let O;for(const N of f.data){if(!N)continue;if(N.x<A){D.length===0?D.push(N):D[0]=N;continue}if(N.x>F){O=N;continue}const K=Math.round(N.x*G),X=Math.round(N.y*de);if(I?.xPixel!==K){y&&y.yPixel!==I?.yPixel&&y.yPixel!==V?.yPixel&&D.push(y.datum),R&&R.yPixel!==I?.yPixel&&R.yPixel!==V?.yPixel&&D.push(R.datum),V&&I?.yPixel!==V.yPixel&&D.push(V.datum),D.push(N),I=V={xPixel:K,yPixel:X,datum:N},y={xPixel:K,yPixel:X,datum:N},R={xPixel:K,yPixel:X,datum:N};continue}V={xPixel:K,yPixel:X,datum:N},y&&X<y.yPixel&&(y.yPixel=X,y.datum=N),R&&X>R.yPixel&&(R.yPixel=X,R.datum=N)}return y&&y.yPixel!==I?.yPixel&&y.yPixel!==V?.yPixel&&D.push(y.datum),R&&R.yPixel!==I?.yPixel&&R.yPixel!==V?.yPixel&&D.push(R.datum),V&&I?.yPixel!==V.yPixel&&D.push(V.datum),O&&D.push(O),{...f,data:D}}function pt(f,T){if(f.data.length<=1)return f;const G=T.width/(T.x.max-T.x.min),de=T.height/(T.y.max-T.y.min),D=T.width,I=[],V=[];for(const y of f.data){if(!y||y.x>T.x.max||y.x<T.x.min)continue;const R=Math.round(y.x*G),A=Math.round(y.y*de)*D+R;V[A]!==!0&&(V[A]=!0,I.push(y))}return{...f,data:I}}var gt="../../packages/studio-base/src/components/TimeBasedChart/index.tsx";const we=Ne.ZP.getLogger(gt),vt=(0,W.ZL)()(f=>({root:{position:"relative"},resetZoomButton:{position:"absolute",bottom:0,right:0,marginBottom:f.spacing(4),marginRight:f.spacing(1)},tooltip:{maxWidth:"none"},bar:{position:"absolute",top:0,bottom:0,width:1,marginLeft:-1,display:"block"},playbackBar:{backgroundColor:"#aaa"}})),he=f=>f.globalBounds,ze=f=>f.setGlobalBounds;function Ue(f){const T=(0,o.useRef)(0),{datasetId:G,type:de,width:D,height:I,data:V,isSynced:y=!1,tooltips:R,yAxes:C,xAxes:A,defaultView:F,currentTime:O,xAxisIsPlaybackTime:N,showXAxisLabels:K}=f,{labels:X,datasets:ce}=V,ee=(0,Te.Z)(),{classes:xe,cx:yt}=vt(),J=(0,o.useMemo)(()=>(0,se.Z)(),[]),Be=(0,ve.Z)(),Ve=(0,o.useRef)(null),[je,Ge]=(0,o.useState)(!1),Xe=(0,dt.An)((0,o.useCallback)(r=>r.pauseFrame,[])),be=(0,o.useRef)(),Ee=(0,o.useRef)(),bt=(0,o.useCallback)(()=>{be.current&&be.current(),be.current=Xe("TimeBasedChart")},[Xe]),Pe=(0,o.useCallback)(()=>{const r=be.current;be.current=void 0,Ee.current=r,r&&(T.current=requestAnimationFrame(()=>{r(),Ee.current=void 0}))},[]);(0,o.useEffect)(()=>()=>{Pe(),cancelAnimationFrame(T.current),Ee.current?.()},[Xe,Pe]);const Le=(0,ye.oA)(he),Ze=(0,ye.oA)(ze),te=(0,o.useMemo)(()=>y?Le:void 0,[Le,y]),Je=(0,o.useMemo)(()=>f.linesToHide??{},[f.linesToHide]),re=(0,o.useRef)(void 0),ne=(0,o.useMemo)(()=>{let r,l,x,B;for(const L of ce)for(const Z of L.data)Z!=null&&(isNaN(Z.x)||(r=Math.min(r??Z.x,Z.x),l=Math.max(l??Z.x,Z.x)),isNaN(Z.x)||(x=Math.min(x??Z.y,Z.y),B=Math.max(B??Z.y,Z.y)));return{x:{min:r,max:l},y:{min:x,max:B}}},[ce]),[Ke,Pt]=(0,o.useState)({}),Qe=(0,U.y1)(()=>{Pt({})},100,{leading:!1,maxWait:100}),qe=()=>{Ge(!1),Ze(void 0)},[_e,Me]=(0,o.useState)(!1),[et,Re]=(0,o.useState)(!1),tt=(0,o.useMemo)(()=>_e?"y":et?"xy":"x",[et,_e]),Mt=o.useMemo(()=>({v:()=>Me(!0),b:()=>Re(!0)}),[Me,Re]),Ye=o.useMemo(()=>({v:()=>Me(!1),b:()=>Re(!1)}),[Me,Re]),He=(0,o.useRef)(void 0),[Ae,pe]=(0,o.useState)(),nt=(0,o.useCallback)(r=>{if(r.length===0||He.current==null)return pe(void 0);const l=[];for(const L of r){if(!L.data)continue;const Z=`${L.data.x}:${L.data.y}:${L.datasetIndex}`,z=R?.get(Z);z&&l.push({item:{...z,datasetIndex:L.datasetIndex},element:L})}if(l.length===0)return pe(void 0);const x=l[0].element,B=Ve.current?.getBoundingClientRect();B&&pe({x:B.left+x.view.x,y:B.top+He.current,data:l.map(L=>L.item)})},[R]),at=(0,ye.D4)(),ot=(0,ye.Js)(),Se=(0,o.useCallback)(()=>ot(J),[ot,J]),St=(0,o.useCallback)(()=>{pe(void 0),Se()},[Se]),e=(0,o.useCallback)(r=>{const l=re.current?.x;if(!l||!Ve.current){pe(void 0),Se();return}const x=Ve.current.getBoundingClientRect();He.current=r.pageY-x.top;const B=r.pageX-x.left,L=l.pixelMax-l.pixelMin,z=(l.max-l.min)/L*(B-l.pixelMin)+l.min;if(!(z>=l.min&&z<=l.max)||isNaN(z)){pe(void 0),Se();return}at({componentId:J,value:z,type:N?"PLAYBACK_SECONDS":"OTHER"})},[at,J,N,Se]),t=(0,o.useMemo)(()=>({decimation:{enabled:!0,algorithm:"lttb"},legend:{display:!1},datalabels:{display:!1},tooltip:{enabled:!1},zoom:{zoom:{enabled:f.zoom,mode:tt,sensitivity:3,speed:.1},pan:{mode:"xy",enabled:!0,speed:20,threshold:10}},...f.plugins,annotation:{annotations:f.annotations}}),[f.annotations,f.plugins,f.zoom,tt]),{min:s,max:n}=(0,o.useMemo)(()=>{if(!te&&je)return{min:void 0,max:void 0};if(te?.sourceId===J&&te.userInteraction)return{min:void 0,max:void 0};let r,l;return F?.type==="fixed"?(r=F.minXValue,l=F.maxXValue):F?.type==="following"?(l=O??0,r=l-F.width):(r=ne.x.min,l=ne.x.max),te?.userInteraction===!0&&(r=te.min,l=te.max),r===l?{min:void 0,max:void 0}:{min:r,max:l}},[J,O,ne.x.max,ne.x.min,F,te,je]),c=(0,o.useMemo)(()=>{const r={font:{family:ie.R.MONOSPACE,size:10},color:ee.palette.text.secondary,maxRotation:0};return{grid:{color:ee.palette.divider},...A,min:s,max:n,ticks:{display:K,...r,...A?.ticks}}},[ee.palette,K,A,s,n]),u=(0,o.useMemo)(()=>{const r={font:{family:ie.R.MONOSPACE,size:10},color:ee.palette.text.secondary,padding:0};let{min:l,max:x}=C;return x==null&&l!=null&&(x=ne.y.max),l==null&&x!=null&&(l=ne.y.min),{type:"linear",...C,min:l,max:x,ticks:{...r,...C.ticks}}},[ne.y,C,ee.palette]),h=(0,o.useRef)(ne);h.current=ne;const m=(0,o.useCallback)(r=>{const l=re.current;let x;l?.x&&l.y&&(x={width:D,height:I,x:{min:l.x.min,max:l.x.max},y:{min:l.y.min,max:l.y.max}});const B=h.current;return!x&&B.x.min!=null&&B.x.max!=null&&B.y.min!=null&&B.y.max!=null&&(x={width:D,height:I,x:{min:B.x.min,max:B.x.max},y:{min:B.y.min,max:B.y.max}}),x?r.map(L=>{if(!x)return L;const Z=L.showLine!==!0?pt(L,x):xt(L,x),z=Z.data.map(ae=>ae==null||isNaN(ae.x)||isNaN(ae.y)?{x:NaN,y:NaN}:ae);return{...Z,data:z}}):[]},[I,D]),d=(0,o.useMemo)(()=>(0,$e.DZ)(ce,r=>{const{label:l}=r;if(!((l==null||Je[l])??!1))return r}),[ce,Je]),p=(0,De.Z)(()=>m,100),w=(0,o.useMemo)(()=>p(d),[Ke,p,d]),M=(0,o.useMemo)(()=>({labels:X,datasets:w}),[X,w]),b=(0,o.useMemo)(()=>({maintainAspectRatio:!1,animation:!1,elements:{line:{tension:0}},interaction:{intersect:!1,mode:"x"},scales:{x:c,y:u},plugins:t}),[t,c,u]),g=(0,o.useCallback)(r=>{Be()&&nt(r)},[Be,nt]),E=(0,o.useCallback)((r,{userInteraction:l})=>{if(Be()&&!(r.x!=null&&(0,_.isEqual)(r.x,re.current?.x)&&!l)&&(l&&Ge(!0),re.current=r,Qe(),!(!y||!r.x))){if(l){Ze({min:r.x.min,max:r.x.max,sourceId:J,userInteraction:!0});return}Ze(x=>{const B=r.x;if(!B)return x;if(!x)return{min:B.min,max:B.max,sourceId:J,userInteraction:!1};if(x.userInteraction)return x;const L=Math.min(B.min,x.min),Z=Math.max(B.max,x.max);return x.max===Z&&x.min===L?x:{min:L,max:Z,sourceId:J,userInteraction:!1}})}},[J,Be,y,Qe,Ze]);(0,o.useEffect)(()=>we.debug(`<TimeBasedChart> (datasetId=${G})`),[G]);const $=(0,o.useMemo)(()=>Object.fromEntries(V.datasets.map((r,l)=>[l,r.borderColor?.toString()])),[V.datasets]),P=(0,o.useMemo)(()=>Object.fromEntries(V.datasets.map((r,l)=>[l,r.label])),[V.datasets]),j=ce.length,H=(0,o.useMemo)(()=>Ae?(0,i.jsx)(ft,{content:Ae.data,multiDataset:j>1,colorsByDatasetIndex:$,labelsByDatasetIndex:P}):void 0,[Ae,$,j,P]),Y=(0,o.useMemo)(()=>y?te?.userInteraction===!0:je,[te?.userInteraction,je,y]),v={type:de,width:D,height:I,isBoundsReset:Le==null,options:b,data:M,onClick:f.onClick,onScalesUpdate:E,onStartRender:bt,onFinishRender:Pe,onHover:g};return D===0||I===0?(0,i.jsx)(i.Fragment,{}):(0,i.jsx)(ue.Z,{direction:"row",fullWidth:!0,children:(0,i.jsx)(oe.Z,{arrow:!1,classes:{tooltip:xe.tooltip},open:Ae!=null,placement:"right",title:H??(0,i.jsx)(i.Fragment,{}),disableInteractive:!0,followCursor:!0,TransitionComponent:S.Z,TransitionProps:{timeout:0},children:(0,i.jsx)(ue.Z,{direction:"row",style:{width:D},children:(0,i.jsxs)("div",{className:xe.root,onDoubleClick:qe,children:[(0,i.jsx)(ct.Z,{componentId:J,isTimestampScale:N,scales:re.current,children:(0,i.jsx)("div",{className:xe.bar,style:{backgroundColor:N?ee.palette.warning.main:ee.palette.info.main}})}),N&&(0,i.jsx)(ht.G,{scales:re.current,xValue:O,children:(0,i.jsx)("div",{className:yt(xe.bar,xe.playbackBar)})}),(0,i.jsx)("div",{ref:Ve,onMouseMove:e,onMouseOut:St,children:(0,i.jsx)(ut.Z,{...v})}),Y&&(0,i.jsx)(fe.Z,{className:xe.resetZoomButton,variant:"contained",color:"inherit",title:"(shortcut: double-click)",onClick:qe,children:"Reset view"}),(0,i.jsx)(Fe.Z,{global:!0,keyDownHandlers:Mt,keyUpHandlers:Ye})]})})})})}},36721:(rt,me,a)=>{a.r(me),a.d(me,{default:()=>St,openSiblingPlotPanel:()=>et,plotableRosTypes:()=>F});var i=a(52322),Te=a(76475),oe=a(47746),S=a(76635),fe=a(5817),_=a.n(fe),o=a(2784),ve=a(667),De=a(57051),W=a(44668),U=a(59506),se=a(1012),$e=a(81187),Ne=a(61187),ut=a(14075),Fe=a(76479),dt=a(49318),ue=a(93812),ye=a(40301),ie=a(27999),ct=a(62515),mt=a(43809),le=a(68071);function Ie(e){return!isNaN(Number.parseFloat(e.value))}function ft(e,t){const s=(0,le.wi)(e.color,t);return{type:"line",display:!0,drawTime:"beforeDatasetsDraw",scaleID:"y",label:{content:e.value,width:"100%",height:"100%"},borderColor:s,borderDash:[5,5],borderWidth:1,value:Number.parseFloat(e.value)}}function ht(e){return(0,ve.DZ)(e,(t,s)=>{if(t.enabled){if(Ie(t))return ft(t,s)}else return})}function xt(e){const t=(0,oe.Z)(),{paths:s,currentTime:n,defaultView:c,showXAxisLabels:u,showYAxisLabels:h,minYValue:m,maxYValue:d,datasets:p,onClick:w,isSynced:M,tooltips:b,xAxisVal:g}=e,E=(0,o.useMemo)(()=>ht(s),[s]),$=(0,o.useMemo)(()=>{const v=isNaN(m)?void 0:m,r=isNaN(d)?void 0:d;return{min:v,max:r,ticks:{display:h,precision:3},grid:{color:t.palette.divider}}},[d,m,h,t]),{width:P,height:j,ref:H}=(0,ct.NB)({refreshRate:0,refreshMode:"debounce"}),Y=(0,o.useMemo)(()=>({datasets:p}),[p]);return(0,i.jsx)("div",{style:{width:"100%",flexGrow:1,overflow:"hidden",padding:"2px"},ref:H,children:(0,i.jsx)(mt.Z,{isSynced:M,zoom:!0,width:P??0,height:j??0,data:Y,tooltips:b,annotations:E,type:"scatter",yAxes:$,xAxisIsPlaybackTime:g==="timestamp",showXAxisLabels:u,currentTime:n,defaultView:c,onClick:w},g)})}var pt=a(71092),gt=a(80348),we=a(52498),vt=a(66198),he=a(1547),ze=a(8740),Ue=a(7565),f=a(72994),T=a(41518),G=a(68434),de=a(20379),D=a(91004),I=a(82044),V=a(5681),y=a(86495),R=a(55601);function C(e){if(e!=="")return e??void 0}function A(e,t){return C(e.label)??C(e.value)??`Series ${t+1}`}const F=["bool","int8","uint8","int16","uint16","int32","uint32","int64","uint64","float32","float64","time","duration","string","json"];var O=a(77075);const N=28,K=(0,ze.ZL)()((e,t,s)=>({root:{display:"contents",cursor:"pointer","&:hover":{"& > *:last-child":{opacity:1},"& > *":{backgroundColor:e.palette.background.paper,backgroundImage:`linear-gradient(${["0deg",e.palette.action.focus,e.palette.action.focus].join(" ,")})`}}},showPlotValue:{[`.${s.plotName}`]:{gridColumn:"span 1"}},listIcon:{display:"flex",alignItems:"center",position:"sticky",height:N,left:0},checkbox:{fontSize:"1em",padding:e.spacing(.975),borderRadius:0,"svg:not(.MuiSvgIcon-root)":{fontSize:"1em"}},disabledPathLabel:{opacity:.5},plotName:{display:"flex",alignItems:"center",height:N,padding:e.spacing(0,1.5,0,.5),gridColumn:"span 2",fontFeatureSettings:`${O.R.SANS_SERIF_FEATURE_SETTINGS}, "zero"`,".MuiTypography-root":{whiteSpace:"nowrap"}},plotValue:{display:"flex",alignItems:"center",height:N,padding:e.spacing(.25,1,.25,.25)},errorIcon:{color:e.palette.error.main}}));function X({currentTime:e,datasets:t,hasMismatchedDataLength:s,index:n,onClickPath:c,path:u,paths:h,savePaths:m,showPlotValuesInLegend:d}){const{openPanelSettings:p}=(0,R.WV)(),{id:w}=(0,I.R)(),{setSelectedPanelIds:M}=(0,V.iy)(),{classes:b,cx:g}=K(),E=(0,o.useMemo)(()=>d?t[n]?.data??[]:[],[t,n,d]),[$]=(0,o.useState)(()=>(0,D.Z)()),P=(0,y.hx)({componentId:$,isTimestampScale:!0}),j=(0,o.useMemo)(()=>{if(!d)return;const H=P?.value??e;let Y;for(const v of E){if(H==null||v==null||v.x>H)break;Y=v.y}return Y},[d,P?.value,e,E]);return(0,i.jsxs)("div",{className:g(b.root,{[b.showPlotValue]:d}),onClick:()=>{M([w]),p(),c()},children:[(0,i.jsx)("div",{className:b.listIcon,children:(0,i.jsx)(T.Z,{className:b.checkbox,checked:u.enabled,size:"small",title:"Toggle visibility",style:{color:(0,le.wi)(u.color,n)},icon:(0,i.jsx)(Ue.uXJ,{}),checkedIcon:(0,i.jsx)(Ue.In2,{}),onChange:H=>{H.stopPropagation();const Y=h.slice(),v=Y[n];v&&(Y[n]={...v,enabled:!v.enabled}),m(Y)}})}),(0,i.jsxs)("div",{className:b.plotName,style:{gridColumn:d?void 0:"span 2"},children:[(0,i.jsx)(G.Z,{noWrap:d,flex:"auto",variant:"body2",className:g({[b.disabledPathLabel]:!u.enabled}),children:A(u,n)}),s&&(0,i.jsx)(de.Z,{placement:"top",title:"Mismatch in the number of elements in x-axis and y-axis messages",children:(0,i.jsx)(f.fXk,{className:b.errorIcon})})]}),d&&(0,i.jsx)("div",{className:b.plotValue,children:(0,i.jsx)(G.Z,{variant:"body2",align:"right",color:P?.value!=null?"warning.main":"text.secondary",children:j??""})})]})}const ce=25,ee=800,xe=(0,ze.ZL)()(({palette:e,shadows:t,shape:s,spacing:n},c,u)=>({root:{display:"flex",overflow:"hidden"},rootFloating:{padding:n(.75),pointerEvents:"none",gap:n(.75),position:"absolute",top:n(4.5),left:n(4),zIndex:1e3,backgroundColor:"transparent",alignItems:"flex-start",height:`calc(100% - ${Fe.B}px - ${n(5.25)})`,overflow:"hidden",[`.${u.container}`]:{pointerEvents:"auto",borderRadius:s.borderRadius,backgroundImage:`linear-gradient(${["0deg",(0,he.Z)(e.background.default).setAlpha(.2).toHex8String(),(0,he.Z)(e.background.default).setAlpha(.2).toHex8String()].join(" ,")})`,backgroundColor:(0,he.Z)(e.background.paper).setAlpha(.8).toHex8String(),backdropFilter:"blur(3px)",maxWidth:`calc(100% - ${n(1)})`,boxShadow:t[3]}},rootLeft:{alignItems:"flex-start",maxWidth:"80%",[`.${u.toggleButton}`]:{padding:n(.25),height:"100%",borderRadius:0,borderTop:"none",borderBottom:"none"},[`.${u.container}`]:{overflow:"auto",height:"100%",alignContent:"flex-start"}},rootTop:{flexDirection:"column",maxHeight:"80%",[`.${u.toggleButton}`]:{padding:n(.25),borderRadius:0,borderRight:"none",borderLeft:"none"}},container:{alignItems:"center",overflow:"auto",display:"grid",gridTemplateColumns:"auto minmax(0, 1fr) auto"},dragHandle:{userSelect:"none",border:`0px solid ${e.action.hover}`,"&:hover":{borderColor:e.action.selected}},toggleButton:{fontSize:"1rem",padding:n(.75),"svg:not(.MuiSvgIcon-root)":{fontSize:"1em"}},toggleButtonFloating:{backdropFilter:"blur(3px)",pointerEvents:"auto",backgroundImage:`linear-gradient(${["0deg",(0,he.Z)(e.background.default).setAlpha(.2).toHex8String(),(0,he.Z)(e.background.default).setAlpha(.2).toHex8String()].join(" ,")})`,backgroundColor:(0,he.Z)(e.background.paper).setAlpha(.8).toHex8String(),boxShadow:t[3],"&:hover":{backgroundColor:e.background.paper,backgroundImage:`linear-gradient(0deg, ${e.action.hover}, ${e.action.hover})`}}}));function yt(e){const{currentTime:t,datasets:s,legendDisplay:n,onClickPath:c,paths:u,pathsWithMismatchedDataLengths:h,saveConfig:m,showLegend:d,showPlotValuesInLegend:p,sidebarDimension:w}=e,{classes:M,cx:b}=xe(),g=(0,o.useRef)({x:0,y:0,sidebarDimension:0}),E=(0,o.useCallback)(()=>m({showLegend:!d}),[d,m]),$=(0,o.useMemo)(()=>{switch(n){case"floating":return d?(0,i.jsx)(pt.iRs,{}):(0,i.jsx)(gt.FEU,{});case"left":return d?(0,i.jsx)(we.YIM,{}):(0,i.jsx)(we.qmn,{});case"top":return d?(0,i.jsx)(we.XRD,{}):(0,i.jsx)(we._4M,{})}},[d,n]),P=(0,o.useCallback)(v=>{if(n==="floating"||v.buttons!==1)return;const r=n==="left"?v.clientX-g.current.x:v.clientY-g.current.y,l=(0,S.clamp)(g.current.sidebarDimension+r,ce,ee);m({sidebarDimension:l})},[n,m]),j=(0,o.useCallback)(v=>{v.currentTarget.setPointerCapture(v.pointerId),g.current={x:v.clientX,y:v.clientY,sidebarDimension:w}},[w]),H=(0,o.useCallback)(v=>{v.currentTarget.releasePointerCapture(v.pointerId)},[]),Y=(0,o.useCallback)(v=>{m({paths:v})},[m]);return(0,i.jsxs)("div",{className:b(M.root,{[M.rootFloating]:n==="floating",[M.rootLeft]:n==="left",[M.rootTop]:n==="top"}),children:[(0,i.jsx)(vt.Z,{onClick:E,className:b(M.toggleButton,{[M.toggleButtonFloating]:n==="floating"}),children:$}),d&&(0,i.jsx)(ue.Z,{flexGrow:1,gap:.5,overflow:"auto",fullHeight:n!=="top",style:{height:n==="top"?Math.round(w):void 0,width:n==="left"?Math.round(w):void 0},children:(0,i.jsx)(ue.Z,{flex:"auto",fullWidth:!0,fullHeight:n!=="top",overflow:n==="floating"?"auto":void 0,children:(0,i.jsx)("div",{className:M.container,children:u.map((v,r)=>(0,i.jsx)(X,{index:r,onClickPath:()=>c(r),path:v,paths:u,hasMismatchedDataLength:h.includes(v.value),datasets:s,currentTime:t,savePaths:Y,showPlotValuesInLegend:p},r))})})}),n!=="floating"&&(0,i.jsx)("div",{className:M.dragHandle,onPointerDown:j,onPointerMove:P,onPointerUp:H,style:n==="left"?{marginLeft:-6,cursor:"ew-resize",borderRightWidth:2,height:"100%",width:4}:{marginTop:-6,cursor:"ns-resize",borderBottomWidth:2,width:"100%",height:4}})]})}var J=a(55433);function Be(e,t){const{x:s,value:n,receiveTime:c,headerStamp:u}=t,h=(0,ie.Eo)(c),m=u?(0,ie.Eo)(u):"";return[s,h,m,e,n]}const Ve=e=>({timestamp:"elapsed time",index:"index",custom:"x value",currentCustom:"x value"})[e];function je(e,t){const s=[Ve(t),"receive time","header.stamp","topic","value"],n=[];n.push(s);for(const c of e)for(const u of c.data)n.push(Be(c.label,u));return n.join(`
`)}function Ge(e,t){const s=je(e,t),n=new Blob([s],{type:"text/csv;charset=utf-8;"});(0,J.G)([{blob:n,fileName:"plot_data.csv"}])}var Xe=a(85091);function be(e){const t=[];for(let s=1;s<e.length;s++){const n=e[s],c=e[s-1],u=n.x-c.x,h=(n.y-c.y)/u;t.push({...n,y:h,value:h,path:`${n.path}.@derivative`})}return t}const Ee={abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,ceil:Math.ceil,cos:Math.cos,log:Math.log,log1p:Math.log1p,log2:Math.log2,log10:Math.log10,round:Math.round,sign:Math.sign,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,trunc:Math.trunc,negative:e=>-e,deg2rad:e=>e*(Math.PI/180),rad2deg:e=>e*(180/Math.PI)};function bt(e,t){let{y:s}=e;const n=Number(s);return isNaN(n)||(s=t(n)),{...e,y:s,value:s,path:`${e.path}.@${t.name}`}}const Pe=e=>e==="custom"||e==="currentCustom";function Le(e,t,s,n,c,u){if(Pe(e)&&u){if(Ie(u))return Number.parseFloat(u.value);if(n){if(!c)return NaN;const h=c.queriedData[s]?.value;return(0,W.isTime)(h)?(0,W.toSec)(h):typeof h=="bigint"?h:Number(h)}}return e==="timestamp"?t:s}function Ze(e,t,s,n,c,u,h){const m=n==="headerStamp"?e.headerStamp:e.receiveTime;if(!m)return{data:[],hasMismatchedData:!1};const d=[],p=(0,W.toSec)((0,W.subtract)(m,s));for(const M of e.queriedData.entries()){const[b,{value:g,path:E,constantName:$}]=M;if(typeof g=="number"||typeof g=="boolean"||typeof g=="string"||typeof g=="bigint"){const P=typeof g=="bigint"?g:Number(g);if(typeof P=="bigint"||!isNaN(P)){const j=Le(c,p,b,h,t,u),H=P;d.push({x:Number(j),y:Number(H),path:E,value:g,constantName:$,receiveTime:e.receiveTime,headerStamp:e.headerStamp})}}else if((0,W.isTime)(g)){const P=Le(c,p,b,h,t,u),j=(0,W.toSec)(g);d.push({x:Number(P),y:j,path:E,receiveTime:e.receiveTime,headerStamp:e.headerStamp,value:`${(0,Xe.WU)(g)} (${(0,ie.Eo)(g)})`,constantName:$})}}const w=Pe(c)&&(!t||e.queriedData.length!==t.queriedData.length);return{data:d,hasMismatchedData:w}}function te({path:e,yAxisRanges:t,index:s,startTime:n,xAxisVal:c,xAxisRanges:u,xAxisPath:h,invertedTheme:m=!1}){let d=!0,p=Pe(c)&&u!=null&&(t.length!==u.length||u.every((E,$)=>E.length!==t[$]?.length));const w=[];let M;for(const E of Object.keys(Ee))if(e.value.endsWith(`.@${E}`)&&(M=Ee[E],M))break;for(const[E,$]of t.entries()){const P=u?.[E];let j=[];for(const[H,Y]of $.entries()){const v=P?.[H],{data:r,hasMismatchedData:l}=Ze(Y,v,n,e.timestampMethod,c,h,u);for(const x of r)M?j.push(bt(x,M)):j.push(x);p=p||l,Y.queriedData.length>1&&c!=="index"&&(d=!1)}e.value.endsWith(".@derivative")&&(d?j=be(j):j=[]),e.timestampMethod==="headerStamp"&&j.sort((H,Y)=>H.x-Y.x),E>0&&w.push({x:NaN,y:NaN,receiveTime:{sec:0,nsec:0},value:"",path:e.value});for(const H of j)w.push(H)}const b=(0,le.wi)(e.color,s);return{dataset:{borderColor:b,label:e.label!=null&&e.label!==""?e.label:e.value,showLine:d,fill:!1,borderWidth:1,pointRadius:1,pointHoverRadius:3,pointBackgroundColor:m?(0,le.UX)(b):(0,le.eE)(b),pointBorderColor:"transparent",data:w},hasMismatchedData:p}}function Je({paths:e,itemsByPath:t,startTime:s,xAxisVal:n,xAxisPath:c,invertedTheme:u}){const h=[];return{datasets:(0,ve.DZ)(e,(d,p)=>{const w=t[d.value]??[],M=c&&t[c.value];if(d.enabled){if(!Ie(d)){const b=te({path:d,yAxisRanges:w,index:p,startTime:s,xAxisVal:n,xAxisRanges:M,xAxisPath:c,invertedTheme:u});return b.hasMismatchedData&&h.push(d.value),b.dataset}}else return}),pathsWithMismatchedDataLengths:h}}var re=a(76665),ne=a(68588),Ke=a(39367);const Pt=_()((e,t,s)=>({actions:[{type:"action",id:"delete-series",label:s("deleteSeries"),display:"inline",icon:"Clear"}],label:A(e,t),visible:e.enabled,fields:{value:{label:s("messagePath"),input:"messagepath",value:e.value,validTypes:F},label:{input:"string",label:s("label"),value:e.label},color:{input:"rgb",label:s("color"),value:e.color??le.Hm[t%le.Hm.length]},timestampMethod:{input:"select",label:s("timestamp"),value:e.timestampMethod,options:[{label:s("receiveTime"),value:"receiveTime"},{label:s("headerStamp"),value:"headerStamp"}]}}})),Qe=_()((e,t)=>{const s=Object.fromEntries(e.map((n,c)=>[`${c}`,Pt(n,c,t)]));return{label:t("series"),children:s,actions:[{type:"action",id:"add-series",label:t("addSeries"),display:"inline",icon:"Addchart"}]}});function qe(e,t){const s=(0,S.isNumber)(e.minYValue)&&(0,S.isNumber)(e.maxYValue)&&e.minYValue>=e.maxYValue?t("maxYError"):void 0,n=(0,S.isNumber)(e.minXValue)&&(0,S.isNumber)(e.maxXValue)&&e.minXValue>=e.maxXValue?t("maxXError"):void 0;return{general:{label:t("general"),fields:{isSynced:{label:t("syncWithOtherPlots"),input:"boolean",value:e.isSynced}}},legend:{label:t("legend"),fields:{legendDisplay:{label:t("position"),input:"select",value:e.legendDisplay,options:[{value:"floating",label:t("floating")},{value:"left",label:t("left")},{value:"top",label:t("top")},{value:"none",label:t("hidden")}]},showPlotValuesInLegend:{label:t("showValues"),input:"boolean",value:e.showPlotValuesInLegend}}},yAxis:{label:t("yAxis"),defaultExpansionState:"collapsed",fields:{showYAxisLabels:{label:t("showLabels"),input:"boolean",value:e.showYAxisLabels},minYValue:{label:t("min"),input:"number",value:e.minYValue!=null?Number(e.minYValue):void 0,placeholder:"auto"},maxYValue:{label:t("max"),input:"number",error:s,value:e.maxYValue!=null?Number(e.maxYValue):void 0,placeholder:"auto"}}},xAxis:{label:t("xAxis"),defaultExpansionState:"collapsed",fields:{xAxisVal:{label:t("value"),input:"select",value:e.xAxisVal,options:[{label:t("timestamp"),value:"timestamp"},{label:t("index"),value:"index"},{label:t("currentPath"),value:"currentCustom"},{label:t("accumulatedPath"),value:"custom"}]},xAxisPath:e.xAxisVal==="currentCustom"||e.xAxisVal==="custom"?{label:t("messagePath"),input:"messagepath",value:e.xAxisPath?.value??"",validTypes:F}:void 0,showXAxisLabels:{label:t("showLabels"),input:"boolean",value:e.showXAxisLabels},minXValue:{label:t("min"),input:"number",value:e.minXValue!=null?Number(e.minXValue):void 0,placeholder:"auto"},maxXValue:{label:t("max"),input:"number",error:n,value:e.maxXValue!=null?Number(e.maxXValue):void 0,placeholder:"auto"},followingViewWidth:{label:t("secondsRange"),input:"number",placeholder:"auto",value:e.followingViewWidth}}},paths:Qe(e.paths,t)}}function _e(e,t,s){const n=(0,Ke.W0)(),{t:c}=(0,ne.$G)("plot"),u=(0,o.useCallback)(h=>{if(h.action==="update"){const{path:m,value:d}=h.payload;t((0,re.ZP)(p=>{m[0]==="paths"?m[2]==="visible"?(0,S.set)(p,[...m.slice(0,2),"enabled"],d):(0,S.set)(p,m,d):(0,S.isEqual)(m,["legend","legendDisplay"])?(p.legendDisplay=d,p.showLegend=!0):(0,S.isEqual)(m,["xAxis","xAxisPath"])?(0,S.set)(p,["xAxisPath","value"],d):((0,S.set)(p,m.slice(1),d),m[1]==="followingViewWidth"?(p.minXValue=void 0,p.maxXValue=void 0):(m[1]==="minXValue"||m[1]==="maxXValue")&&(p.followingViewWidth=void 0))}))}else if(h.payload.id==="add-series")t((0,re.ZP)(m=>{m.paths.push({timestampMethod:"receiveTime",value:"",enabled:!0})}));else if(h.payload.id==="delete-series"){const m=h.payload.path[1];t((0,re.ZP)(d=>{d.paths.splice(Number(m),1)}))}},[t]);(0,o.useEffect)(()=>{n({actionHandler:u,focusedPath:s,nodes:qe(e,c)})},[u,e,s,n,c])}const Me=240;function et(e,t){e({panelType:"Plot",updateIfExists:!0,siblingConfigCreator:s=>({...s,paths:(0,S.uniq)(s.paths.concat([{value:t,enabled:!0,timestampMethod:"receiveTime"}]).filter(({value:n})=>n))})})}const Re=e=>{const t={};return Object.entries(e).forEach(([s,n])=>{t[s]=[n.map(c=>{const u=(0,ie.IJ)(c.messageEvent.message);return{queriedData:c.queriedData,receiveTime:c.messageEvent.receiveTime,headerStamp:u}})]}),t},tt=_()((e,t)=>Object.freeze(Re(e(t)))),Mt={sec:0,nsec:0},Ye=window.performance;function He(e){const t=new Map;for(const[s,n]of e.entries())for(const c of n.data)t.set(`${c.x}:${c.y}:${s}`,c);return t}function Ae(e,t){const s={},n={};let c=0,u=0;for(const h of t){const m=tt(e,h);if(c>=1e6)if(Ye.memory){const d=Ye.memory.usedJSHeapSize/Ye.memory.jsHeapSizeLimit;if(isNaN(d)||d>.6)return s}else return s;for(const[d,p]of Object.entries(m)){c+=p[0]?.[0]?.queriedData.length??0;const w=s[d]??[],[M]=p;if(n[d]===u-1){const b=w[w.length-1];if(b&&M)for(const g of M)b.push(g)}else M&&w.push(M.slice());s[d]=w,n[d]=u}u+=1}return s}function pe(e){return e.playerState.activeData?.startTime}function nt(e){return e.playerState.activeData?.currentTime}function at(e){return e.playerState.activeData?.endTime}function ot(e){const{saveConfig:t,config:s}=e,{title:n,followingViewWidth:c,paths:u,minXValue:h,maxXValue:m,minYValue:d,maxYValue:p,showXAxisLabels:w,showYAxisLabels:M,showLegend:b,legendDisplay:g=s.showSidebar===!0?"left":"floating",showPlotValuesInLegend:E,isSynced:$,xAxisVal:P,xAxisPath:j,sidebarDimension:H=s.sidebarWidth??Me,[ye.xS]:Y}=s;(0,o.useEffect)(()=>{n&&(Y==null||Y==="")&&t({title:void 0,[ye.xS]:n})},[Y,n,t]);const v=(0,oe.Z)();(0,o.useEffect)(()=>{u.length===0&&t({paths:[{value:"",enabled:!0,timestampMethod:"receiveTime"}]})},[t,u.length]);const r=P==="currentCustom"||P==="index",l=(0,Ne.An)(pe),x=(0,Ne.An)(nt),B=(0,Ne.An)(at),L=k=>{if(P==="timestamp"&&k&&l)return(0,W.toSec)((0,W.subtract)(k,l))},Z=L(x),z=(0,o.useMemo)(()=>{if(c!=null&&+c>0)return{type:"following",width:+c}},[c]),ae=L(B),Ct=(0,o.useMemo)(()=>{if((0,S.isNumber)(h)&&(0,S.isNumber)(ae)||(0,S.isNumber)(m))return{type:"fixed",minXValue:(0,S.isNumber)(h)?h:0,maxXValue:(0,S.isNumber)(m)?m:ae??0};if(P==="timestamp"&&l&&ae!=null)return{type:"fixed",minXValue:0,maxXValue:ae}},[m,h,ae,l,P]),Ft=(0,o.useMemo)(()=>{if(z)return z;if(Ct)return Ct},[Ct,z]),ge=(0,o.useMemo)(()=>u.map(({value:k})=>k).concat((0,S.compact)([j?.value])),[j?.value,u]),Dt=(0,o.useMemo)(()=>(0,se.UU)(ge),[ge]),Nt=(0,$e.Iq)(ge),It=(0,$e.wm)(ge),wt=(0,o.useMemo)(()=>{const k=new Map;for(const Q of ge){const q=(0,se.ZP)(Q);if(!q)continue;const Ce=k.get(q.topicName)??[];Ce.push(Q),k.set(q.topicName,Ce)}return k},[ge]),Bt=(0,U.Bv)(Dt),st=(0,o.useMemo)(()=>r?{}:Ae(It,Bt),[Bt,It,r]),Xt=(0,o.useCallback)(k=>{if(!k)return{};const Q={};for(const q of ge){const Ce=k[q];Ce&&(Q[q]=Ce)}return Q},[ge]),Yt=(0,o.useMemo)(()=>Object.keys(st),[st]),Vt=(0,De.O4)(Yt),Ht=(0,o.useCallback)((k,Q)=>{const q=Q[Q.length-1]?.receiveTime,Ce=z?.type==="following";let ke;for(const it of Q){const Lt=wt.get(it.topic);if(Lt)for(const We of Lt){if(Vt.includes(We))continue;const Zt=Nt(We,it);if(!Zt)continue;const Jt=(0,ie.IJ)(it.message),Tt={queriedData:Zt,receiveTime:it.receiveTime,headerStamp:Jt};if(ke||(ke={...k}),r)ke[We]=[[Tt]];else{const lt=ke[We]?.slice()??[[]],Rt=lt[0];if(q&&Ce){const Kt=(0,W.toSec)(q)-z.width,At=(0,ve.DZ)(Rt,kt=>{if(!((0,W.toSec)(kt.receiveTime)<Kt))return kt});At.push(Tt),lt[0]=At}else lt[0]=Rt.concat(Tt);ke[We]=lt}}}return ke??k},[Vt,Nt,z,r,wt]),jt=(0,De.O4)((0,U.CC)({topics:Dt,preloadType:"full",restore:Xt,addMessages:Ht})),{datasets:Oe,pathsWithMismatchedDataLengths:Ot}=(0,o.useMemo)(()=>{const k={...jt,...st};return Je({paths:u,itemsByPath:k,startTime:l??Mt,xAxisVal:P,xAxisPath:j,invertedTheme:v.palette.mode==="dark"})},[jt,st,u,l,P,j,v]),Wt=(0,o.useMemo)(()=>b&&E?new Map:He(Oe),[Oe,b,E]),Et=(0,Ne.m7)(),$t=(0,o.useCallback)(({x:k})=>{const{seekPlayback:Q,playerState:{activeData:{startTime:q}={}}}=Et();!Q||!q||k==null||P!=="timestamp"||k>=0&&Q((0,W.add)(q,(0,W.fromSec)(k)))},[Et,P]),[zt,Ut]=(0,o.useState)(void 0);_e(s,t,zt);const Gt=(0,o.useMemo)(()=>g==="top"?"column":"row",[g]);return(0,i.jsxs)(ue.Z,{flex:"auto",alignItems:"center",justifyContent:"center",overflow:"hidden",position:"relative",children:[(0,i.jsx)(Fe.Z,{additionalIcons:(0,i.jsx)(dt.Z,{onClick:()=>Ge(Oe,P),title:"Download plot data as CSV",children:(0,i.jsx)(Te.Z,{fontSize:"small"})})}),(0,i.jsxs)(ue.Z,{direction:Gt,flex:"auto",fullWidth:!0,style:{height:`calc(100% - ${Fe.B}px)`},children:[g!=="none"&&(0,i.jsx)(yt,{paths:u,datasets:Oe,currentTime:Z,onClickPath:k=>Ut(["paths",String(k)]),saveConfig:t,showLegend:b,pathsWithMismatchedDataLengths:Ot,legendDisplay:g,showPlotValuesInLegend:E,sidebarDimension:H}),(0,i.jsx)(ue.Z,{flex:"auto",alignItems:"center",justifyContent:"center",overflow:"hidden",children:(0,i.jsx)(xt,{isSynced:P==="timestamp"&&$,paths:u,minYValue:parseFloat((d??"").toString()),maxYValue:parseFloat((p??"").toString()),showXAxisLabels:w,showYAxisLabels:M,datasets:Oe,tooltips:Wt,xAxisVal:P,currentTime:Z,onClick:$t,defaultView:Ft})})]})]})}const Se={title:"Plot",paths:[{value:"",enabled:!0,timestampMethod:"receiveTime"}],minYValue:void 0,maxYValue:void 0,showXAxisLabels:!0,showYAxisLabels:!0,showLegend:!0,legendDisplay:"floating",showPlotValuesInLegend:!1,isSynced:!0,xAxisVal:"timestamp",sidebarDimension:Me},St=(0,ut.Z)(Object.assign(ot,{panelType:"Plot",defaultConfig:Se}))},68071:(rt,me,a)=>{a.d(me,{A2:()=>o,Hm:()=>fe,UX:()=>ve,eE:()=>De,wi:()=>W});var i=a(76635),Te=a.n(i),oe=a(1547),S=a(25302);const fe=[S.Y.blue.medium,S.Y.orange.medium,S.Y.yellow.medium,S.Y.green.medium,S.Y.cyan.medium,S.Y.purple.medium,S.Y.paleGreen.medium],_=fe.map(U=>[U,...(0,oe.Z)(U).tetrad().map(se=>se.toHexString())]),o=(0,i.uniq)((0,i.range)(0,_[0].length).map(U=>_.map(se=>se[U])).flat()),ve=(0,i.memoize)(U=>(0,oe.Z)(U).brighten(15).toString()),De=(0,i.memoize)(U=>(0,oe.Z)(U).darken(30).toString());function W(U,se){return U??fe[se%fe.length]}},25302:(rt,me,a)=>{a.d(me,{B:()=>oe,Y:()=>Te});var i=a(1547);const Te={base:{dark:"#1F1E27",medium:"#8B8B8D",light:"#F7F7F3"},red:{dark:"#F24366",medium:"#ff7c96",light:"#FFAABB"},blue:{dark:"#1b83ec",medium:"#4e98e2",light:"#77AADD"},paleGreen:{dark:"#B4CC00",medium:"#cad660",light:"#CDD67E"},orange:{dark:"#ea531f",medium:"#f5774d",light:"#faa487"},cyan:{dark:"#22b5ff",medium:"#61cbff",light:"#99DDFF"},green:{dark:"#05d27d",medium:"#5cd6a9",light:"#8de0c9"},purple:{dark:"#6E51EE",medium:"#a395e2",light:"#c7c0e7"},yellow:{dark:"#EDCC28",medium:"#f7df71",light:"#f1e4aa"}},oe=(0,i.Z)("hsv(0, 0%, 75%)").toHexString()}}]);

//# sourceMappingURL=6721.b5a6bc6608e12a2e59da.js.map