(()=>{"use strict";var N={42042:(t,c,s)=>{var d=s(90758);const g={canHandle:i=>i instanceof AbortSignal,deserialize:([i,e])=>{const r=new AbortController;return i?r.abort():e.onmessage=()=>{r.abort()},r.signal},serialize:i=>{const{port1:e,port2:r}=new MessageChannel;return i.addEventListener("abort",()=>{e.postMessage("aborted")}),[[i.aborted,r],[r]]}};var a=s(44668);const w=Object.freeze({sec:0,nsec:0});class b{constructor(e,r){this._iter=e,this._abort=r}async next(){return this._abort?.aborted===!0?void 0:(await this._iter.next()).value}async nextBatch(e){const r=await this.next();if(!r)return;if(r.type==="problem")return[r];const o=[r];let l=w;switch(r.type){case"stamp":l=(0,a.add)(r.stamp,{sec:0,nsec:e*1e6});break;case"message-event":l=(0,a.add)(r.msgEvent.receiveTime,{sec:0,nsec:e*1e6});break}for(;;){const u=await this.next();if(!u)return o;if(o.push(u),u.type==="problem"||u.type==="stamp"&&(0,a.compare)(u.stamp,l)>0||u.type==="message-event"&&(0,a.compare)(u.msgEvent.receiveTime,l)>0)break}return o}async readUntil(e){if(this._abort?.aborted===!0)return;const o=[];if(this._lastIteratorResult?.type==="stamp"&&(0,a.compare)(this._lastIteratorResult.stamp,e)>=0||this._lastIteratorResult?.type==="message-event"&&(0,a.compare)(this._lastIteratorResult.msgEvent.receiveTime,e)>0)return o;for(this._lastIteratorResult&&(o.push(this._lastIteratorResult),this._lastIteratorResult=void 0);;){const l=await this._iter.next();if(this._abort?.aborted===!0)return;if(l.done===!0)break;const u=l.value;if(u.type==="stamp"&&(0,a.compare)(u.stamp,e)>=0){this._lastIteratorResult=u;break}if(u.type==="message-event"&&(0,a.compare)(u.msgEvent.receiveTime,e)>0){this._lastIteratorResult=u;break}o.push(u)}return o}async end(){await this._iter.return?.()}}class x{constructor(e){this._source=e}async initialize(){return await this._source.initialize()}messageIterator(e){return d.sj(this._source.messageIterator(e))}async getBackfillMessages(e,r){return await this._source.getBackfillMessages({...e,abortSignal:r})}getMessageCursor(e,r){const o=this._source.messageIterator(e),l=new b(o,r);return d.sj(l)}}d.Y6.set("abortsignal",g);const R=new Map,p=()=>{};class T{constructor(e){this._name=e,this.setLevel("debug"),R.set(e,this)}name(){return this._name}isLevelOn(e){switch(e){case"debug":return this.debug!==p;case"info":return this.info!==p;case"warn":return this.warn!==p;case"error":return this.error!==p}return!1}getLevel(){return this.debug!==p?"debug":this.info!==p?"info":this.warn!==p?"warn":"error"}setLevel(e){switch(this.debug=p,this.info=p,this.warn=p,this.error=p,e){case"debug":this.debug=console.debug.bind(s.g.console),this.info=console.info.bind(s.g.console),this.warn=console.warn.bind(s.g.console),this.error=console.error.bind(s.g.console);break;case"info":this.info=console.info.bind(s.g.console),this.warn=console.warn.bind(s.g.console),this.error=console.error.bind(s.g.console);break;case"warn":this.warn=console.warn.bind(s.g.console),this.error=console.error.bind(s.g.console);break;case"error":this.error=console.error.bind(s.g.console);break}}debug(...e){}info(...e){}warn(...e){}error(...e){}getLogger(e){const r=e.replace(/^.+\.(asar|webpack)[\\/\\]/,"").replace(/^(\.\.\/)+/,""),o=this._name.length>0?`${this._name}.${r}`:r,l=R.get(o);if(l)return l;const u=new T(o);return R.set(o,u),u}channels(){return Array.from(R.values())}}T.default=new T("");function ee(i){switch(i){case"debug":return"debug";case"info":return"info";case"warn":return"warn";case"error":return"error";default:return"warn"}}const z=T.default;var P=s(13900),m=s(24234),$=s(32909);function F(i,e){return e.subscriptions.get(i)?.name}function H(i){const e=[];for(const r of i.fields){const o=r.type==="char";e.push({name:r.name,type:G(r.type),isArray:r.arrayLength!=null&&!o,arrayLength:o?void 0:r.arrayLength,upperBound:o?r.arrayLength??1:void 0,isComplex:r.isComplex})}return{name:i.name,definitions:e}}function W(i){switch(i){case m.LogLevel.Emerg:case m.LogLevel.Alert:case m.LogLevel.Crit:return 16;case m.LogLevel.Err:return 8;case m.LogLevel.Warning:return 4;case m.LogLevel.Notice:case m.LogLevel.Info:return 2;case m.LogLevel.Debug:default:return 1}}function G(i){switch(i){case"int8_t":return"int8";case"uint8_t":return"uint8";case"int16_t":return"int16";case"uint16_t":return"uint16";case"int32_t":return"int32";case"uint32_t":return"uint32";case"int64_t":return"int64";case"uint64_t":return"uint64";case"float":return"float32";case"double":return"float64";case"bool":return"bool";case"char":return"string";default:return i}}var Z="../../packages/studio-base/src/players/IterablePlayer/ulog/UlogIterableSource.ts";const J=1024*1024,_="Log",O=z.getLogger(Z);class K{constructor(e){this.options=e}async initialize(){const e=this.options.file,r=this.options.file.size;O.debug(`initialize(${r} bytes)`);const o=performance.now();this.ulog=new m.ULog(new $.BlobReader(e),{chunkSize:J}),await this.ulog.open();const l=performance.now()-o;O.debug(`opened in ${l.toFixed(2)}ms`);const u=this.ulog.dataMessageCounts(),S=this.ulog.timeRange()??[0n,0n],h=(0,a.fromMicros)(Number(S[0])),v=(0,a.fromMicros)(Number(S[1])),E=[],M=[],y=new Map,C=new Map,Q={},V={},j=this.ulog.header;M.push({name:_,schemaName:"rosgraph_msgs/Log"}),y.set(_,{numMessages:this.ulog.logCount()??0}),C.set("rosgraph_msgs/Log",P.ros1["rosgraph_msgs/Log"]);for(const L of j.definitions.values())C.set(L.name,H(L));const D=new Set;for(const[L,k]of this.ulog.subscriptions.entries()){const B=u.get(L);if(B==null||B===0)continue;const I=F(L,this.ulog);if(I&&!D.has(I)){D.add(I),M.push({name:I,schemaName:k.name}),y.set(I,{numMessages:B}),Q[I]=k.format;const U=C.get(k.name);U&&(V[I]=[U])}}const X=new Map;for(const[L,k]of j.parameters.entries())X.set(L,k.value);return O.debug("message definitions parsed"),this.start=h,this.end=v,{start:h,end:v,topics:M,datatypes:C,profile:"ulog",problems:E,publishersByTopic:new Map,topicStats:y}}async*messageIterator(e){if(this.ulog==null)throw new Error("UlogDataProvider is not initialized");const r=e.topics,o=e.start??this.start,l=e.end??this.end;if(!o||!l)throw new Error("UlogDataProvider is not initialized");if(r.length===0)return;const u=BigInt(Math.floor((0,a.toMicroSec)(o))),S=BigInt(Math.floor((0,a.toMicroSec)(l)));for await(const h of this.ulog.readMessages({startTime:u,endTime:S}))if(h.type===m.MessageType.Data){const v=h.value.timestamp,E=(0,a.fromMicros)(Number(v)),M=this.ulog.subscriptions.get(h.msgId),y=M?.name;y&&r.includes(y)&&(0,a.isTimeInRangeInclusive)(E,o,l)&&(yield{type:"message-event",msgEvent:{topic:y,receiveTime:E,message:h.value,sizeInBytes:h.data.byteLength,schemaName:M.name}})}else if(h.type===m.MessageType.Log||h.type===m.MessageType.LogTagged){const v=(0,a.fromMicros)(Number(h.timestamp));r.includes(_)&&(0,a.isTimeInRangeInclusive)(v,o,l)&&(yield{type:"message-event",msgEvent:{topic:_,receiveTime:v,message:{file:"",function:"",header:{stamp:v},level:W(h.logLevel),line:0,msg:h.message,name:""},schemaName:"rosgraph_msgs/Log",sizeInBytes:h.size}})}}async getBackfillMessages(e){return[]}}function Y(i){if(!i.file)throw new Error("file required");const e=new K({type:"file",file:i.file}),r=new x(e);return d.sj(r)}d.Jj(Y)}},A={};function n(t){var c=A[t];if(c!==void 0)return c.exports;var s=A[t]={exports:{}};return N[t].call(s.exports,s,s.exports,n),s.exports}n.m=N,n.x=()=>{var t=n.O(void 0,[1524],()=>n(42042));return t=n.O(t),t},(()=>{var t=[];n.O=(c,s,d,f)=>{if(s){f=f||0;for(var g=t.length;g>0&&t[g-1][2]>f;g--)t[g]=t[g-1];t[g]=[s,d,f];return}for(var a=1/0,g=0;g<t.length;g++){for(var[s,d,f]=t[g],w=!0,b=0;b<s.length;b++)(f&!1||a>=f)&&Object.keys(n.O).every(z=>n.O[z](s[b]))?s.splice(b--,1):(w=!1,f<a&&(a=f));if(w){t.splice(g--,1);var x=d();x!==void 0&&(c=x)}}return c}})(),n.d=(t,c)=>{for(var s in c)n.o(c,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:c[s]})},n.f={},n.e=t=>Promise.all(Object.keys(n.f).reduce((c,s)=>(n.f[s](t,c),c),[])),n.u=t=>""+t+".db752d10b7550a29ef3e.js",n.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),n.o=(t,c)=>Object.prototype.hasOwnProperty.call(t,c),(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var c=n.g.document;if(!t&&c&&(c.currentScript&&(t=c.currentScript.src),!t)){var s=c.getElementsByTagName("script");s.length&&(t=s[s.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),(()=>{var t={2042:1},c=f=>{var[g,a,w]=f;for(var b in a)n.o(a,b)&&(n.m[b]=a[b]);for(w&&w(n);g.length;)t[g.pop()]=1;d(f)};n.f.i=(f,g)=>{t[f]||importScripts(n.p+n.u(f))};var s=self.webpackChunk=self.webpackChunk||[],d=s.push.bind(s);s.push=c})(),(()=>{var t=n.x;n.x=()=>n.e(1524).then(t)})();var q=n.x()})();

//# sourceMappingURL=2042.7c930ca2e241e88e6c68.js.map