"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8508],{62506:(pe,A,e)=>{e.d(A,{s:()=>k});var s=e(2784),F=e(59506),W=e(1012),Y=e(81187);function k(a,o){const{historySize:h=1}=o??{},S=(0,s.useMemo)(()=>(0,W.ZP)(a),[a]),x=(0,s.useMemo)(()=>S?[S.topicName]:[],[S]),P=(0,Y.Iq)([a]),b=(0,s.useCallback)((d,r)=>{if(r.length===0)return d;const u=[];for(let j=r.length-1;j>=0&&u.length<h;--j){const p=r[j],v=P(a,p);v&&v.length>0&&u.push({messageEvent:p,queriedData:v})}const m=u.reverse();return u.length===h?{matches:m,messageEvents:r,path:a}:{matches:d.matches.concat(m).slice(-h),messageEvents:r,path:a}},[P,h,a]),X=(0,s.useCallback)(d=>{if(!d)return{matches:[],messageEvents:[],path:a};const r=[];for(const u of d.messageEvents){const m=P(a,u);m&&m.length>0&&r.push({messageEvent:u,queriedData:m})}return r.length>0||a!==d.path?{matches:r.slice(-h),messageEvents:d.messageEvents,path:a}:d},[P,h,a]);return(0,F.CC)({topics:x,addMessages:b,restore:X}).matches}},18508:(pe,A,e)=>{e.r(A),e.d(A,{default:()=>Ce});var s=e(52322),F=e(47746),W=e(20379),Y=e(17055),k=e(86232),a=e(76635),o=e(2784),h=e(62515),S=e(8740),x=e(667),P=e(25934),b=e(29268),X=e(86451),se=e(35870),d=e(62506),r=e(14075),u=e(76479),m=e(93812);function ne(i,{initiallyTrue:I}){const f=(0,o.useRef)(I?void 0:i),y=!(0,a.isEqual)(f.current,i);return f.current=i,y}const j=i=>{const{datapoints:I}=i;return(0,s.jsx)("div",{children:I.sort((f,y)=>y.y-f.y).map(({x:f,y},U)=>(0,s.jsx)("div",{style:{padding:"4px 0",display:"flex",alignItems:"center"},children:(0,s.jsxs)("div",{children:[f,", ",y]})},U))})};function p(i){return i==null?Number.NaN:parseFloat(i)}var v=e(2784);const ve=(0,S.ZL)()(i=>({resetButton:{position:"absolute",marginRight:i.spacing(2.5),marginBottom:i.spacing(7),bottom:0,right:0}})),ye=["message"],K=["order","label","backgroundColor","borderColor","borderDash","borderWidth","pointBackgroundColor","pointBorderColor","pointBorderWidth","pointRadius","pointStyle","lineTension","data"],Me={height:"100%"};function De(i){const{config:I,saveConfig:f,onFinishRender:y}=i,{path:U,minXVal:ae,maxXVal:oe,minYVal:ie,maxYVal:le,pointRadiusOverride:N}=I,z=(0,F.Z)(),{classes:Ze}=ve(),[C,H]=v.useState(!1),[re,G]=v.useState(!1),[de,w]=v.useState(!1),Z=(0,d.s)(U.value)[0]?.queriedData[0]?.value,{title:J,yAxisLabel:Q,xAxisLabel:$,gridColor:V=z.palette.divider}=Z??{},M=(0,o.useMemo)(()=>{if(!Z)return[];const{lines:n=[],points:t=[],polygons:l=[]}=Z,g=(0,x.DZ)(n,D=>{const{data:c,...O}=(0,a.pick)(D,K);if(c==null)return;const T={data:c.map(B=>({x:B.x,y:B.y})),showLine:!0,fill:!1,...O};return N!=null&&(T.pointRadius=parseFloat(N)),T}),te=(0,x.DZ)(t,D=>{const{data:c,...O}=(0,a.pick)(D,K);if(c==null)return;const T={data:c.map(B=>({x:B.x,y:B.y})),showLine:!0,fill:!1,...O};return N!=null&&(T.pointRadius=parseFloat(N)),T}),be=(0,x.DZ)(l,D=>{const{data:c,...O}=(0,a.pick)(D,K);if(c==null)return;const E=c.map(xe=>({x:xe.x,y:xe.y}));return{data:E[0]!=null?E.concat([E[0]]):E,fill:!0,pointRadius:0,showLine:!0,lineTension:0,...O}});return[...g,...te,...be].sort((D,c)=>(c.order??0)-(D.order??0))},[Z,N]),{allXs:q,allYs:_}=(0,o.useMemo)(()=>{const n=(0,x.DZ)((0,a.flatten)(M.map(t=>t.data)),t=>t??void 0);return{allXs:n.map(({x:t})=>t),allYs:n.map(({y:t})=>t)}},[M]),R=(0,o.useCallback)(n=>{const t=Math.min(...n),l=Math.max(...n),g=l-t;return{min:g===0?t-1:t-g*.05,max:g===0?l+1:l+g*.05}},[]),ce=(0,o.useMemo)(()=>{const n=p(ie),t=p(le),l=C?void 0:{min:isNaN(n)?R(_).min:n,max:isNaN(t)?R(_).max:t};return{grid:{color:V},title:{display:Q!=null,text:Q},...l}},[_,R,V,C,le,ie,Q]),ue=(0,o.useMemo)(()=>{const n=p(ae),t=p(oe),l=C?void 0:{min:isNaN(n)?R(q).min:n,max:isNaN(t)?R(q).max:t};return{grid:{color:V},title:{display:$!=null,text:$},...l}},[q,R,V,C,oe,ae,$]),me=(0,o.useMemo)(()=>re?"y":de?"xy":"x",[de,re]),Re=(0,o.useMemo)(()=>({scales:{y:ce,x:ue},color:z.palette.text.secondary,animation:{duration:0},plugins:{title:{display:J!=null,text:J,color:z.palette.text.primary},tooltip:{intersect:!1,mode:"nearest",enabled:!1},datalabels:{display:!1},legend:{display:!1},zoom:{zoom:{enabled:!0,mode:me,sensitivity:3,speed:.1},pan:{mode:"xy",enabled:!0,speed:20,threshold:10}}}}),[z,J,ue,ce,me]),Ee=(0,o.useCallback)((n,t)=>{t.userInteraction&&H(!0)},[]),[L,fe]=(0,o.useState)(),Te=(0,o.useMemo)(()=>(0,s.jsx)(j,{datapoints:L?.data??[]}),[L?.data]),{width:Be=0,height:Se=0,ref:ee}=(0,h.NB)({refreshRate:0,refreshMode:"debounce"}),je=(0,o.useCallback)(n=>{const t=n[0];if(!t){fe(void 0);return}const l=ee.current?.getBoundingClientRect();if(l){const g=(0,x.DZ)(n,te=>te.data);fe({x:l.left+t.view.x,y:l.top+t.view.y,data:g})}},[ee]),Ie=(0,o.useCallback)(()=>{H(!1)},[H]);ne([(0,a.pick)(i.config,["minXVal","maxXVal","minYVal","maxYVal"])],{initiallyTrue:!1})&&C&&H(!1);const Ne=(0,o.useMemo)(()=>({v:()=>G(!0),b:()=>w(!0)}),[]),Le=(0,o.useMemo)(()=>({v:()=>G(!1),b:()=>w(!1)}),[G,w]),Oe=(0,o.useCallback)(n=>f({path:{value:n}}),[f]);if((0,a.uniq)(M.map(({label:n})=>n)).length!==M.length)throw new Error("2D Plot datasets do not have unique labels");const Ae=(0,o.useMemo)(()=>({datasets:M}),[M]),he=M.length===0,ge=(0,o.useMemo)(()=>{if(Z){if(he)return(0,s.jsx)(b.Z,{children:"No 2D Plot data (lines, points, polygons) to visualize"})}else return(0,s.jsx)(b.Z,{children:"Waiting for next message"})},[he,Z]);return(0,s.jsxs)(m.Z,{flex:"auto",fullHeight:!0,children:[(0,s.jsx)(u.Z,{children:(0,s.jsx)(se.ZP,{path:U.value,onChange:Oe,inputStyle:Me,validTypes:ye,placeholder:"Select topic messages with 2D Plot data to visualize",autoSize:!0})}),(0,s.jsx)(m.Z,{ref:ee,direction:"row",flex:"auto",fullWidth:!0,overflow:"hidden",position:"relative",children:ge||(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W.Z,{open:L!=null,placement:"right",title:Te,disableInteractive:!0,TransitionComponent:Y.Z,TransitionProps:{timeout:0},PopperProps:{anchorEl:{getBoundingClientRect:()=>new DOMRect(L?.x??0,L?.y??0,0,0)}},children:(0,s.jsx)("div",{})}),(0,s.jsx)(P.Z,{type:"scatter",width:Be,height:Se,options:Re,isBoundsReset:!1,onScalesUpdate:Ee,onHover:je,data:Ae,onFinishRender:y}),C&&(0,s.jsx)(k.Z,{className:Ze.resetButton,"data-testid":"reset-zoom",variant:"contained",color:"inherit",title:"(shortcut: double-click)",onClick:Ie,children:"Reset view"}),(0,s.jsx)(X.Z,{global:!0,keyDownHandlers:Ne,keyUpHandlers:Le})]})})]})}const Pe={path:{value:""}},Ce=(0,r.Z)(Object.assign(De,{panelType:"TwoDimensionalPlot",defaultConfig:Pe}))}}]);

//# sourceMappingURL=8508.1359f51012bee7f8b906.js.map